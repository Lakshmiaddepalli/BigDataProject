var df5 = df.join(df4, Seq("Community Area"), "left_outer")

df5.printSchema()
root
 |-- Community Area: string (nullable = true)
 |-- ID: string (nullable = true)
 |-- Case Number: string (nullable = true)
 |-- Block: string (nullable = true)
 |-- IUCR: string (nullable = true)
 |-- Primary Type: string (nullable = true)
 |-- Description: string (nullable = true)
 |-- Location Description: string (nullable = true)
 |-- Arrest: string (nullable = true)
 |-- Domestic: string (nullable = true)
 |-- Beat: string (nullable = true)
 |-- District: string (nullable = true)
 |-- Ward: string (nullable = true)
 |-- FBI Code: string (nullable = true)
 |-- X Coordinate: string (nullable = true)
 |-- Y Coordinate: string (nullable = true)
 |-- Year: string (nullable = true)
 |-- Updated On: string (nullable = true)
 |-- Latitude: string (nullable = true)
 |-- Longitude: string (nullable = true)
 |-- Location: string (nullable = true)
 |-- Date_of_Crime: date (nullable = true)
 |-- Time: string (nullable = true)
 |-- SERVICE REQUEST TYPE: string (nullable = true)
 |-- SERVICE REQUEST NUMBER: string (nullable = true)
 |-- IF THE BUILDING IS OPEN, WHERE IS THE ENTRY POINT?: string (nullable = true)
 |-- IS THE BUILDING CURRENTLY VACANT OR OCCUPIED?: string (nullable = true)
 |-- IS THE BUILDING VACANT DUE TO FIRE?: string (nullable = true)
 |-- ANY PEOPLE USING PROPERTY? (HOMELESS, CHILDEN, GANGS): string (nullable = true)
 |-- ADDRESS STREET NUMBER: string (nullable = true)
 |-- ADDRESS STREET DIRECTION: string (nullable = true)
 |-- ADDRESS STREET NAME: string (nullable = true)
 |-- ADDRESS STREET SUFFIX: string (nullable = true)
 |-- LATITUDE: string (nullable = true)
 |-- LONGITUDE: string (nullable = true)
 |-- Census Tracts: string (nullable = true)
 |-- DateServiceRequest: date (nullable = true)
 
 //Not Working as date is not being filtered
 var CommunityWiseNumberofVacantBuildings = df5.groupBy($"Community Area",$"IS THE BUILDING CURRENTLY VACANT OR OCCUPIED?").count().orderBy(desc("count"))
CommunityWiseNumberofVacantBuildings.where($"IS THE BUILDING CURRENTLY VACANT OR OCCUPIED?" == "VACANT").show()
